<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.1.js"></script>
    <title>json ë‹¤ë£¨ê¸°(ì¢…ëŸ‰ì œ)</title>
</head>
<body>
    ì‹œë„ëª… <input type="text" id="inputRegion">
    ì‹œêµ°êµ¬ëª… <input type="text" id="inputCity">
    <br><br>
    ë´‰íˆ¬ìš©ëŸ‰
    <select id="inputSize">
        <option value="5â„“ê°€ê²©">5ë¦¬í„°</option>
        <option value="10â„“ê°€ê²©">10ë¦¬í„°</option>
        <option value="20â„“ê°€ê²©">20ë¦¬í„°</option>
        <option value="50â„“ê°€ê²©">50ë¦¬í„°</option>
        <option value="100â„“ê°€ê²©">100ë¦¬í„°</option>
    </select>
    <input type="button" value="ê²€ìƒ‰" onclick="f_search()">

    <br><br>
    <input type="button" id="price_bnt" value="ê°€ê²©ìˆœâ–¼" onclick="f_arange('price')">
    <input type="button" value="ì‹œêµ°êµ¬â–¼" onclick="f_arange('city')">
    <!-- í¬ê¸°ë¥¼ ì§€ì •í•´ì„œ ìŠ¤í¬ë¡¤ë°” ë§Œë“¤ê¸° -->
    <div id="headerTable"></div>
    <div id="resultTable" style="width: 800px; height: 400px; overflow-y:scroll;"></div>

   

    










    <!-- ./ == í˜„ì¬í´ë” -->
    <!-- ê³µê³µë°ì´í„°í¬í„¸ - ì „êµ­ì¢…ëŸ‰ì œë´‰íˆ¬ê°€ê²©í‘œì¤€ë°ì´í„° -->
    <script src="./01_priceJS.js"></script>
    <script>
        /* let v_json = {};
        v_json.name = "ì°¬ì›…";
        v_json = {"name" : "ì°¬ì›…", "age" : 30}; */

        // ë‹¤ë¥¸ê³³ì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ ì¼ë‹¨ì€ ìƒìˆ˜ì— ë‹´ìŒìœ¼ë¡œì¨
        // ì›ë³¸ë°ì´í„°ë¥¼ ë³´ì¡´ì‹œì¼œì¤€ë‹¤
        const jsonData = c_data;
        console.log(jsonData);

        // í‚¤ê°’ ê°€ì ¸ì˜¤ê¸°
        const c_records = jsonData["records"];
        // const c_records = jsonData.records;
        console.log("c_records : ", c_records);         // ë°°ì—´

        console.log("c_records[0] : ", c_records[0]);   // jsonê°ì²´
        console.log("c_records[0]['5â„“ê°€ê²©'] : " ,c_records[0]["5â„“ê°€ê²©"]);

        // json ê°ì²´ì˜ keyê°’ë“¤ì„ ë°°ì—´ë¡œ ê°€ì ¸ì˜¤ê¸°
        const keyList = Object.keys(c_records[0]);
        console.log("keyList : " , keyList);

        // c_recordsì—ì„œ ì„œìš¸íŠ¹ë³„ì‹œì— í•´ë‹¹í•˜ëŠ” ë°ì´í„° ì¤‘
        // ì‹œë„ëª… : ì„œìš¸íŠ¹ë³„ì‹œ
        // ì¢…ëŸ‰ì œë´‰íˆ¬ì‚¬ìš©ëŒ€ìƒ : ê°€ì •ìš©
        // ì¢…ë‘ì œë´‰íˆ¬ìš©ë„ : ìƒí™œì“°ë ˆê¸°
        // ì¢…ëŸ‰ì œë´‰íˆ¬ì¢…ë¥˜ : ê·œê²©ë´‰íˆ¬
        // ì¢…ëŸ‰ì œë´‰íˆ¬ì²˜ë¦¬ë°©ì‹ : ì†Œê°ìš©
        // ì— í•´ë‹¹í•˜ëŠ” ëª¨ë“ ë°ì´í„°ë¥¼ v_seoulì— ë‹´ê¸°

        let v_seoul = [];
        
        // ë°°ì—´ì— ê°’ ì§‘ì–´ë„£ê¸° ë¡œì§..
        // v_seoul[v_seoul.length] = "ê°€"; == v_seoul[0] = "ê°€"
        // v_seoul[v_seoul.length] = "ë‚˜"; == v_seoul[1] = "ë‚˜"


        for(let i = 0; i < c_records.length; i++){
            // console.log(c_records[i][keyList[0]])
            let c_records_index = c_records[i];

            if((   c_records_index[keyList[0]] == 'ì„œìš¸íŠ¹ë³„ì‹œ') 
                && c_records_index[keyList[5]] == 'ê°€ì •ìš©' 
                && c_records_index[keyList[4]] == 'ìƒí™œì“°ë ˆê¸°'
                && c_records_index[keyList[2]] == 'ê·œê²©ë´‰íˆ¬'
                && c_records_index[keyList[3]] == 'ì†Œê°ìš©' ){
                /* ì¡°ê±´ë¬¸ ë ì‹¤í–‰ë¬¸ */
                // ë°°ì—´ì— ì§‘ì–´ë„£ê¸° .push or [i] = ~~
                // v_seoul.push(c_records_index);
                v_seoul[v_seoul.length] = c_records_index;
            }
        }
        
        console.log("v_seoul : " , v_seoul);

        let test = "í…ŒìŠ¤íŠ¸ ì…ë‹ˆë‹¤~";
        console.log("ğŸš€ ~ file: 01.JSONë‹¤ë£¨ê¸°(ì¢…ëŸ‰ì œ).html:103 ~ test", test)

        // ì„œìš¸ ì¢…ëŸ‰ì œ ë´‰íˆ¬ 10ë¦¬í„° ì¤‘ ê°€ê²©ì´ ê°€ì¥ ë¹„ì‹¼ ë™ë„¤ ë½‘ê¸°
        // ì„œìš¸ ì¢…ëŸ‰ì œ ë´‰íˆ¬ë¥¼ ë‹¤ ë‹´ì€ ë°°ì—´ ë§Œë“¤ê¸°
        // ê·¸ ì¤‘ì—ì„œ 10ë¦¬í„° ê°’ì´ ì œì¼ í° ì¸ë±ìŠ¤

        let seoul_arry = []
        for(let i = 0; i < c_records.length; i++){
            if(c_records[i][keyList[0]] == 'ì„œìš¸íŠ¹ë³„ì‹œ'){
                seoul_arry.push(c_records[i]);
            }
        }

        console.log("ğŸš€ ~ file: 01.JSONë‹¤ë£¨ê¸°(ì¢…ëŸ‰ì œ).html:82 ~ seoul_arry", seoul_arry)

        let maxResult = seoul_arry[0];

        for(let i = 0; i < seoul_arry.length; i++){
            console.log("maxResult : " , maxResult[keyList[12]]);
            console.log("iì˜ 10ë¦¬í„° ê°€ê²©: " ,parseInt(seoul_arry[i][keyList[12]]));

            if(parseInt(maxResult) < parseInt(seoul_arry[i][keyList[12]])){
                maxResult = seoul_arry[i]
            }
        }
            
        console.log("ğŸš€ ~ file: 01.JSONë‹¤ë£¨ê¸°(ì¢…ëŸ‰ì œ).html:93 ~ maxResult", maxResult)
        console.log("ì„œìš¸ì—ì„œ 10l ì¢…ëŸ‰ì œê°€ ê°€ì¥ ë¹„ì‹¼ ë™ë„¤ : ", maxResult[keyList[1]])


        

        // v_seoul ì—ì„œ 10ë¦¬í„° ê°€ê²©ì´ 380ì›ì¸ ë™ë„¤ë¥¼ ì „ë¶€ ë°°ì—´ì— ë‹´ê¸°
        let v_richCityList = [];

        for(let i = 0; i < v_seoul.length; i++){
            if(v_seoul[i][keyList[12]] == 380){
                v_richCityList.push(v_seoul[i])
            }
        }
        console.log("ğŸš€ ~ file: 01.JSONë‹¤ë£¨ê¸°(ì¢…ëŸ‰ì œ).html:109 ~ v_richCityList", v_richCityList)



        // ì„œìš¸ ì¢…ëŸ‰ì œ ë´‰íˆ¬ 10ë¦¬í„° ê°€ê²©ì˜ í‰ê·  êµ¬í•˜ê¸°

        let totalPrice = 0;
        let v_seoul_length = v_seoul.length;
        // parseIntê¸°ì–µí•˜ê¸° ìë°”ëŠ” Integer.parseInt()
        for(let i = 0 ; i < v_seoul.length; i++){
            totalPrice += parseInt(v_seoul[i][keyList[12]]);
            console.log("ì˜¤ì‰", v_seoul[i][keyList[12]]);
        }

        console.log("totalPrice : " , totalPrice)
        console.log("v_seoul_length : " , v_seoul_length)
        console.log("real average : " , Math.round(totalPrice/v_seoul_length))

    </script>


    <script>
        // í™”ë©´ì— ê·¸ë¦¬ê¸°
        const v_resultTable = document.getElementById("resultTable");
        // document.getElementById("headerTable").innerHTML += "<h3>" + keyList[0] + " | " + keyList[1] + " | " + keyList[12] +"</h3>";
        
        // ì „ì—­ìœ¼ë¡œ ë³€ìˆ˜ í•˜ë‚˜ ì„ ì–¸..
        // ê²€ìƒ‰ ê²°ê³¼ ë°ì´í„°
        let v_resultData = [];

        // ì¨ì¹˜ ë°¸ë¥˜ ë½‘ê¸° ìœ„í•´ ì „ì—­ë³€ìˆ˜ ì„ ì–¸
        let v_select = "";



        // ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„
        function f_search(){
            const v_inputRegion = document.getElementById("inputRegion");
            const v_inputCity = document.getElementById("inputCity");
            const v_inputSize = document.getElementById("inputSize");

            // select íƒœê·¸ì—ì„œ ì„ íƒí•œ ê°’ ë½‘ê¸°
            // .optionsë¥¼ í•˜ë©´ ì˜µì…˜íƒœê·¸ ì „ë¶€ ë°°ì—´ë¡œ ë‹´ì•„ì¤€ë‹¤
            const v_options = v_inputSize.options;
            for(let i = 0; i < v_options.length; i++){
                if(v_options[i].selected){
                    v_select = v_options[i].value;
                }
            }
            console.log("v_select : " + v_select);


            // ê²€ìƒ‰ ëª©ë¡ ë¹„ìš°ê¸°
            v_resultTable.innerHTML = "";
            // ê²€ìƒ‰ ê²°ê³¼ ë°°ì—´ë„ ë¹„ìš°ê¸°
            v_resultData = [];

            // forë¬¸ í™”ë©´ ê·¸ë¦¬ê¸°    
            for(let i = 0; i < c_records.length; i++){
                /* ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ê·¸ë¦¬ê¸°..
                v_resultTable.innerHTML += "<h3>" + c_records[i]["ì‹œë„ëª…"] 
                                        + " | " + c_records[i]["ì‹œêµ°êµ¬ëª…"]
                                        + " | " + c_records[i]["10â„“ê°€ê²©"] + "</h3>";
                */
                // ê²€ìƒ‰ì–´ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ”ì§€ ì²´í¬
                let c_records_index = c_records[i];

                if(c_records_index[keyList[5]] == 'ê°€ì •ìš©' 
                && c_records_index[keyList[4]] == 'ìƒí™œì“°ë ˆê¸°'
                && c_records_index[keyList[2]] == 'ê·œê²©ë´‰íˆ¬'
                && c_records_index[keyList[3]] == 'ì†Œê°ìš©' ){

                    if(c_records[i]["ì‹œë„ëª…"].indexOf(v_inputRegion.value) != -1
                        && c_records[i]["ì‹œêµ°êµ¬ëª…"].indexOf(v_inputCity.value) != -1){
                        // ì „ì—­ ë³€ìˆ˜ì¸ ë°°ì—´ì— ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë‹´ê¸°
                        v_resultData.push(c_records[i]);
                        // ê²€ìƒ‰ì–´ ê·¸ë¦¬ê¸°
                        v_resultTable.innerHTML += `<h3>${c_records[i]["ì‹œë„ëª…"]}
                            | ${c_records[i]["ì‹œêµ°êµ¬ëª…"]}
                            | ${[v_select]}
                            | ${c_records[i][v_select]}</h3>`;
                    }
                }
            }            
        }

        // ì •ë ¬
        // ë¬¸ì œ
        // í•œë²ˆ ì •ë ¬ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë²„íŠ¼ì´ ê°€ê²©ìˆœâ–¼ì—ì„œ ê°€ê²©ìˆœâ–² ìœ¼ë¡œ ë°”ë€Œê³ 
        // ì—­ìˆœìœ¼ë¡œ ì •ë ¬ì´ ë˜ë„ë¡ ê¸°ëŠ¥ ì¶”ê°€í•˜ê¸°
        function f_arange(p_type){


            // ë°°ì—´ ì •ë ¬!! í•¨ìˆ˜?
            // sort()ì»ì„ ë•Œ ë°°ì—´ì— ë‹¤ ìˆ«ìë©´ ìƒê´€ì—†ì§€ë§Œ
            // ìˆ«ìê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì§€ì •í•´ì¤˜ì•¼ í•œë‹¤
            // sort ì•ˆì— ë“¤ì–´ê°€ëŠ” ìµëª…í•¨ìˆ˜ëŠ” compareFunctionì´ë¼ í•œë‹¤
            // compareFunctionì˜ ë¦¬í„´ê°’ì´ ìŒìˆ˜ì¸ì§€ ì–‘ìˆ˜ì¸ì§€ì— ë”°ë¼ ì •ë ¬ì´ ì´ë£¨ì–´ì§„ë‹¤

            if(p_type == 'price'){
                let price_bnt_val = $("#price_bnt").val();
                console.log(price_bnt_val);
                // ë²„íŠ¼ ëª¨ì–‘ ë°”ê¿”ì£¼ê³ 
                ( price_bnt_val == "ê°€ê²©ìˆœâ–²") ? $("#price_bnt").val("ê°€ê²©ìˆœâ–¼") : $("#price_bnt").val("ê°€ê²©ìˆœâ–²");

                if(price_bnt_val == "ê°€ê²©ìˆœâ–¼"){
                    v_resultData.sort(function(a, b){
                    return a[v_select] - b[v_select]
                    });
                }else if(price_bnt_val == "ê°€ê²©ìˆœâ–²"){
                    v_resultData.sort(function(a, b){
                    return b[v_select] - a[v_select]
                    });
                }
                


               


            }else if(p_type == 'city'){
                // ë¬¸ìì—´ì˜ ê²½ìš° ìœ ë‹ˆì½”ë“œ ìˆ«ìì— ëŒ€í•´ ë¶€ë“±í˜¸ ë¹„êµëŠ” ë˜ìë§Œ
                // ë¹¼ê¸° ì—°ì‚°ì´ ì•ˆëœë‹¤
                // ë”°ë¼ì„œ ë¶€ë“±í˜¸ ë¹„êµ ê²°ê³¼ì— ë”°ë¥¸ ë¦¬í„´ê°’ì„ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.
                v_resultData.sort(function(a, b){
                    let resultCnt = 0
                    a["ì‹œêµ°êµ¬ëª…"] > b["ì‹œêµ°êµ¬ëª…"] ? resultCnt = 1 : resultCnt = -1;

                    return resultCnt;
                });
            }


            // ì •ë ¬í›„ ë¹„ì›Œì£¼ê³ 
            v_resultTable.innerHTML = "";
            
            // ë‹¤ì‹œ ê·¸ë ¤ì£¼ì
            for(let i = 0; i < v_resultData.length; i++){
                v_resultTable.innerHTML += `<h3>${v_resultData[i]["ì‹œë„ëª…"]}
                            | ${v_resultData[i]["ì‹œêµ°êµ¬ëª…"]}
                            | ${[v_select]}
                            | ${v_resultData[i][v_select]}</h3>`;
            }

        }


    </script>    
</body>
</html>